!function(l){var a,t,n,i,o,r,d,p,c,u,h,f,v,m=!1;function w(){"function"==typeof zxcvbn?(n.val()?k():(n.val(n.data("pw")),n.trigger("pwupdate")),y(),1!==parseInt(c.data("start-masked"),10)?t.addClass("show-password"):c.trigger("click"),l("#pw-weak-text-label").html(userProfileL10n.warnWeak)):setTimeout(w,50)}function g(){c.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden"),i.focus(),o.attr("for","pass1-text")}function b(){var e,s;a=l(".user-pass1-wrap"),o=a.find("th label").attr("for","pass1-text"),l(".user-pass2-wrap").hide(),h=l("#submit").on("click",function(){m=!1}),u=h.add(" #createusersub"),d=l(".pw-weak"),(p=d.find(".pw-checkbox")).change(function(){u.prop("disabled",!p.prop("checked"))}),(n=l("#pass1")).length&&(f=n.val(),t=n.parent(),i=l('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(n[0].className).data("pw",n.data("pw")).val(n.val()).on(v,function(){i.val()!==f&&(r.val(i.val()),n.val(i.val()).trigger("pwupdate"),f=i.val())}),n.after(i),1===parseInt(n.data("reveal"),10)&&w(),n.on(v+" pwupdate",function(){n.val()!==f&&(f=n.val(),i.val()!==f&&i.val(f),n.add(i).removeClass("short bad good strong"),y())})),r=l("#pass2").on(v,function(){0<r.val().length&&(n.val(r.val()),r.val(""),f="",n.trigger("pwupdate"))}),n.is(":hidden")&&(n.prop("disabled",!0),r.prop("disabled",!0),i.prop("disabled",!0)),e=a.find(".wp-pwd"),s=a.find("button.wp-generate-pw"),(c=a.find(".wp-hide-pw")).show().on("click",function(){1===parseInt(c.data("toggle"),10)?(t.addClass("show-password"),g(),_.isUndefined(i[0].setSelectionRange)||i[0].setSelectionRange(0,100)):(t.removeClass("show-password"),c.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),n.focus(),o.attr("for","pass1"),_.isUndefined(n[0].setSelectionRange)||n[0].setSelectionRange(0,100))}),s.length&&e.hide(),s.show(),s.on("click",function(){m=!0,s.hide(),e.show(),n.attr("disabled",!1),r.attr("disabled",!1),i.attr("disabled",!1),0===i.val().length&&w(),_.defer(function(){i.focus(),_.isUndefined(i[0].setSelectionRange)||i[0].setSelectionRange(0,100)},0)}),a.find("button.wp-cancel-pw").on("click",function(){m=!1,i.val(""),wp.ajax.post("generate-password").done(function(e){n.data("pw",e)}),s.show(),e.hide(),d.hide(0,function(){p.removeProp("checked")}),n.prop("disabled",!0),r.prop("disabled",!0),i.prop("disabled",!0),g(),a.closest("form").is("#your-profile")&&(n.val("").trigger("pwupdate"),u.prop("disabled",!1))}),a.closest("form").on("submit",function(){m=!1,n.prop("disabled",!1),r.prop("disabled",!1),r.val(n.val()),t.removeClass("show-password")})}function k(){var e=l("#pass1").val();if(l("#pass-strength-result").removeClass("short bad good strong"),e)switch(wp.passwordStrength.meter(e,wp.passwordStrength.userInputBlacklist(),e)){case-1:l("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:l("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:l("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:l("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:l("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:l("#pass-strength-result").addClass("short").html(pwsL10n["short"])}else l("#pass-strength-result").html("&nbsp;")}function y(){var e=l("#pass-strength-result")[0];e.className&&(n.add(i).addClass(e.className),"short"===e.className||"bad"===e.className?(p.prop("checked")||u.prop("disabled",!0),d.show()):(u.prop("disabled",!1),d.hide()))}v="oninput"in document.createElement("input")?"input":"keyup",l(document).ready(function(){var e,a,t,n,i=l("#display_name"),s=i.val(),o=l("#wp-admin-bar-my-account").find(".display-name");l("#pass1").val("").on(v+" pwupdate",k),l("#pass-strength-result").show(),l(".color-palette").click(function(){l(this).siblings('input[name="admin_color"]').prop("checked",!0)}),i.length&&(l("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var a=[],t={display_nickname:l("#nickname").val()||"",display_username:l("#user_login").val()||"",display_firstname:l("#first_name").val()||"",display_lastname:l("#last_name").val()||""};t.display_firstname&&t.display_lastname&&(t.display_firstlast=t.display_firstname+" "+t.display_lastname,t.display_lastfirst=t.display_lastname+" "+t.display_firstname),l.each(l("option",i),function(e,s){a.push(s.value)}),l.each(t,function(e,s){s&&(s=s.replace(/<\/?[a-z][^>]*>/gi,""),t[e].length&&-1===l.inArray(s,a)&&(a.push(s),l("<option />",{text:s}).appendTo(i)))})}),i.on("change",function(){var e;t===n&&(e=l.trim(this.value)||s,o.text(e))})),e=l("#color-picker"),a=l("#colors-css"),t=l("input#user_id").val(),n=l('input[name="checkuser_id"]').val(),e.on("click.colorpicker",".color-option",function(){var e,s=l(this);if(!s.hasClass("selected")&&(s.siblings(".selected").removeClass("selected"),s.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if((a=0===a.length?l('<link rel="stylesheet" />').appendTo("head"):a).attr("href",s.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{e=l.parseJSON(s.children(".icon_colors").val())}catch(e){}e&&(wp.svgPainter.setColors(e),wp.svgPainter.paint())}l.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:s.children('input[name="admin_color"]').val(),nonce:l("#color-nonce").val()}).done(function(e){e.success&&l("body").removeClass(e.data.previousScheme).addClass(e.data.currentScheme)})}}),b()}),l("#destroy-sessions").on("click",function(e){var s=l(this);wp.ajax.post("destroy-sessions",{nonce:l("#_wpnonce").val(),user_id:l("#user_id").val()}).done(function(e){s.prop("disabled",!0),s.siblings(".notice").remove(),s.before('<div class="notice notice-success inline"><p>'+e.message+"</p></div>")}).fail(function(e){s.siblings(".notice").remove(),s.before('<div class="notice notice-error inline"><p>'+e.message+"</p></div>")}),e.preventDefault()}),window.generatePassword=w,l(window).on("beforeunload",function(){if(!0===m)return userProfileL10n.warn})}(jQuery);